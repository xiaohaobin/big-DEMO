<!DOCTYPE html>

<html>

	<head>
		<meta charset="UTF-8">
		<title>capture screen</title>
	</head>

	<body>
		<video id="video" controls="controls" style="display: none;">
			<source src="test2.mp4">
		</video>
		<div id="output"></div>
		<script src="js/jquery-2.1.0.js" type="text/javascript" charset="utf-8"></script>
		<script type="text/javascript">
//			(function() {
//				var video, output;
//				var scale = 0.8;
//				var initialize = function() {
//					output = document.getElementById("output");
//					video = document.getElementById("video");
//					video.addEventListener('loadeddata', captureImage); // 用于向指定元素添加事件句柄。
//				};
//
//				var captureImage = function() {
//					var canvas = document.createElement("canvas"); // 创建一个画布
//					canvas.width = video.videoWidth * scale;
//					canvas.height = video.videoHeight * scale;
//					canvas.getContext('2d').drawImage(video, 0, 0, canvas.width, canvas.height); // getContext:设置画布环境；drawImage:画画 
//
//					var img = document.createElement("img");
//					img.src = canvas.toDataURL("image/png"); // 获取图片的url
//					output.appendChild(img);
//				};
//
//				initialize();
//			})();

			
			var mainFn = {
				getVideoImg:function(jsObj,fn){
					var video;
					var scale = 0.8;
					var initialize = function() {
						video = jsObj;
						video.addEventListener('loadeddata', captureImage); // 用于向指定元素添加事件句柄。
					};
	
					var captureImage = function() {
						var canvas = document.createElement("canvas"); // 创建一个画布
						canvas.width = video.videoWidth * scale;
						canvas.height = video.videoHeight * scale;
						canvas.getContext('2d').drawImage(video, 0, 0, canvas.width, canvas.height); // getContext:设置画布环境；drawImage:画画 
						var imgUrl = canvas.toDataURL("image/png");
						if(fn) fn(imgUrl);
						
					};
	
					initialize();
				},
			};
			
			mainFn.getVideoImg(
				$("#video")[0],
				function(url){
					console.log(url);
				}
			);
		</script>
	</body>

</html>